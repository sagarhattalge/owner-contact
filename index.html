<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Contact Owner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: #f3f4f6;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .card {
      background: #ffffff;
      padding: 24px 20px 28px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
      max-width: 380px;
      width: 100%;
      text-align: center;
    }
    h1 {
      font-size: 22px;
      margin: 0 0 8px;
    }
    p {
      font-size: 14px;
      color: #4b5563;
      margin: 0 0 20px;
    }
    .btn {
      display: block;
      width: 100%;
      padding: 12px 16px;
      margin: 8px 0;
      border-radius: 999px;
      border: none;
      font-size: 16px;
      cursor: pointer;
      text-decoration: none;
      text-align: center;
      font-weight: 600;
    }
    .btn-call {
      background: #16a34a;
      color: #ffffff;
    }
    .btn-whatsapp {
      background: #22c55e;
      color: #ffffff;
    }
    .note {
      font-size: 12px;
      color: #9ca3af;
      margin-top: 14px;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>Contact Owner</h1>
    <p>Use one of the options below to reach the vehicle owner.</p>

    <!-- Call button -->
    <a class="btn btn-call" href="tel:+918805219473">
      Call Owner
    </a>

    <!-- WhatsApp button -->
    <a class="btn btn-whatsapp"
       href="https://wa.me/918805219473?text=Hello,%20I%20am%20contacting%20you%20regarding%20your%20car.">
      WhatsApp Owner
    </a>

    <div class="note">
      For parking / emergency communication only.
    </div>
  </div>

  <!-- Logging + IP geolocation script -->
  <script>
  (function() {

    // ðŸ”´ IMPORTANT: paste your Apps Script Web App URL between the quotes:
    var LOG_URL = "https://script.google.com/macros/s/AKfycbwM86gRBeiH_FdEZX6A_tGmQLTHdxcn7UX445hZpcuCfJrbv608VKRNuC5Ea8MqZ4A4xQ/exec";

    function getDeviceType() {
      if (/mobile/i.test(navigator.userAgent)) return "Mobile";
      if (/tablet/i.test(navigator.userAgent)) return "Tablet";
      return "Desktop";
    }

    function getOS() {
      var ua = navigator.userAgent;
      if (/android/i.test(ua)) return "Android";
      if (/iphone|ipad|ipod/i.test(ua)) return "iOS";
      if (/windows/i.test(ua)) return "Windows";
      if (/macintosh/i.test(ua)) return "MacOS";
      return "Other";
    }

    function getBrowser() {
      var ua = navigator.userAgent;
      if (/edg/i.test(ua)) return "Edge";
      if (/chrome/i.test(ua)) return "Chrome";
      if (/safari/i.test(ua) && !/chrome/i.test(ua)) return "Safari";
      if (/firefox/i.test(ua)) return "Firefox";
      return "Other";
    }

    function extractModel() {
      var ua = navigator.userAgent;

      // Android example: "; SM-M325F Build/"
      var match = ua.match(/;\s?([A-Z0-9\-]+)\s?Build/i);
      if (match) return match[1];

      if (/iPhone/i.test(ua)) return "iPhone";
      if (/iPad/i.test(ua)) return "iPad";

      return "Unknown";
    }

    function sendLog(extra) {
      extra = extra || {};

      var params = {
        url:        window.location.href,
        ref:        document.referrer || "",
        ua:         navigator.userAgent || "",
        deviceType: getDeviceType(),
        os:         getOS(),
        browser:    getBrowser(),
        model:      extractModel(),
        screen:     window.screen.width + "x" + window.screen.height,
        pixelRatio: String(window.devicePixelRatio || 1),
        orient:     (screen.orientation && screen.orientation.type) ? screen.orientation.type : "unknown",
        language:   navigator.language || "",
        timezone:   (Intl.DateTimeFormat().resolvedOptions().timeZone || ""),

        // IP fields from API
        ip:          extra.ip          || "",
        city:        extra.city        || "",
        region:      extra.region      || "",
        country:     extra.country     || "",
        countryCode: extra.countryCode || "",
        postal:      extra.postal      || "",
        latitude:    extra.latitude    || "",
        longitude:   extra.longitude   || "",
        isp:         extra.isp         || "",
        org:         extra.org         || "",
        asn:         extra.asn         || ""
      };

      var qs = Object.keys(params)
        .map(function(key) {
          return key + "=" + encodeURIComponent(params[key]);
        })
        .join("&");

      try {
        var img = new Image();
        img.src = LOG_URL + "?" + qs;
      } catch (e) {
        // ignore
      }
    }

    function fetchIpAndLog() {
  fetch("https://ipapi.co/json/")
    .then(function(res) { return res.json(); })
    .then(function(data) {
      var extra = {
        ip:          data.ip || "",
        city:        data.city || "",
        region:      data.region || "",
        country:     data.country_name || "",
        countryCode: data.country || "",
        postal:      data.postal || "",
        latitude:    (data.latitude != null ? String(data.latitude) : ""),
        longitude:   (data.longitude != null ? String(data.longitude) : ""),
        isp:         data.org || "",
        org:         data.org || "",
        asn:         data.asn || ""
      };
      sendLog(extra);
    })
    .catch(function(err) {
      sendLog({});
    });
}

    // Start the logging as soon as page loads
    try {
      fetchIpAndLog();
    } catch (e) {
      sendLog({});
    }

  })();
  </script>
</body>
</html>
